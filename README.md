# ETL-Python-PostgreSQL
Ежедневно некоторая информационная система выгружает файл в формате xlsx, в котором в ненормализованном виде содержатся накопительно все транзакции (за 3 дня), совершенные за предыдущие дни месяца (накопление происходит с начала месяца). В файле к транзакциям привязаны сведения о клиенте, номера договора, карт и пр.
В файле «transactions_01052020.xlsx» - содержатся транзакции за 01.05.2020. В файле «transactions_02052020.xlsx» - содержатся транзакции за 01.05.2020 и 02.05.2020. В файле «transactions_03052020.xlsx» - содержатся транзакции за 01.05.2020, 02.05.2020 и 03.05.2020.
Необходимо разработать ETL-процесс, который ежедневно получает выгрузку, загружает ее в хранилище данных согласно структуре хранилища и ежедневно строит отчет.
При загрузке данных должна быть обеспечена версионность данных 1 или 2 типа. Ко всем таблицам SCD1 должны быть добавлены технические поля create_dt (дата создания версии), update_dt (дата изменения версии). Ко всем таблицам SCD2 должны быть добавлены технические поля start_dt и end_dt – начало и конец периода существования версии.
Построение отчета
По результатам загрузки ежедневно необходимо строить витрину данных для финансового отдела по подозрению на проведение мошеннических операций. Витрина должна строиться накопительно.
Предполагаемыми мошенническими действиями являются:
1) Совершение операции при просроченном паспорте.
2) Совершение операции при недействующем договоре.
3) Совершение операции в разных городах в течение 1 часа.
4) Попытка подбора сумм. В течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней. Последняя операция (успешная) в такой цепочке считается мошеннической.
